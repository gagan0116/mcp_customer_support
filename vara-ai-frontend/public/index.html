<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VARA.ai</title>
    <meta name="description"
        content="AI-powered customer support automation demo - simulate email processing, verification, and policy adjudication">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Background Effects -->
    <div class="bg-gradient"></div>
    <div class="bg-grid"></div>
    <div class="floating-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon" style="overflow: hidden;">
                    <img src="favicon.png" alt="Logo" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div class="logo-text">
                    <span class="logo-title">VARA-AI</span>
                    <span class="logo-subtitle">AI based Customer Support</span>
                </div>
            </div>
            <nav class="header-nav">
                <a href="#" class="nav-link active">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                    </svg>
                    <span>Email Pipeline</span>
                </a>
                <a href="/policy-knowledge-base" class="nav-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="18" cy="5" r="3" />
                        <circle cx="6" cy="12" r="3" />
                        <circle cx="18" cy="19" r="3" />
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" />
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
                    </svg>
                    <span>Policy Knowledge Base</span>
                </a>
            </nav>
            <div class="header-status">
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span class="status-text">System Ready</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Left Panel: Email Preview -->
        <section class="panel panel-input">
            <div class="panel-header">
                <div class="panel-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                        <polyline points="22,6 12,13 2,6" />
                    </svg>
                </div>
                <h2 class="panel-title">Incoming Support Email</h2>
            </div>

            <!-- Demo Scenario Selection -->
            <div class="scenario-section">
                <div class="section-header">
                    <span class="step-badge">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                            height="14">
                            <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                    </span>
                    <h3>Select Demo Scenario</h3>
                </div>
                <div class="scenario-select-wrapper">
                    <select id="scenarioSelect" class="select-input">
                        <option value="">-- Choose a demo scenario --</option>
                    </select>
                    <div class="select-arrow">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Email Preview (appears on selection) -->
            <div id="emailPreview" class="email-preview hidden">
                <!-- Email Header -->
                <div class="email-header-card">
                    <div class="email-meta-row">
                        <div class="email-meta-item">
                            <span class="meta-label">To:</span>
                            <span class="meta-value support-email">vara.assist@gmail.com</span>
                        </div>
                    </div>

                    <div class="email-meta-row">
                        <div class="email-meta-item">
                            <span class="meta-label">Received:</span>
                            <span class="meta-value" id="receivedAt"></span>
                        </div>
                    </div>
                </div>

                <!-- Email Body -->
                <div class="email-body-section">
                    <div class="section-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                            height="14">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14 2 14 8 20 8" />
                            <line x1="16" y1="13" x2="8" y2="13" />
                            <line x1="16" y1="17" x2="8" y2="17" />
                        </svg>
                        Email Content
                    </div>
                    <div class="email-body-content" id="emailBody">
                        <!-- Email body will be inserted here -->
                    </div>
                </div>

                <!-- Attachments -->
                <div class="attachments-section">
                    <div class="section-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                            height="14">
                            <path
                                d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48" />
                        </svg>
                        Attachments
                    </div>
                    <div class="attachments-list" id="attachmentsList">
                        <!-- Attachments will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="empty-state">
                <div class="empty-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                        <polyline points="22,6 12,13 2,6" />
                    </svg>
                </div>
                <h3>No Email Selected</h3>
                <p>Select a demo scenario above to preview the incoming customer support email</p>
            </div>

            <!-- Submit Button -->
            <div class="submit-section" id="submitSection">
                <button class="submit-btn" id="submitBtn" disabled>
                    <span class="btn-content">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                        <span>Process Email Request</span>
                    </span>
                    <span class="btn-loader hidden">
                        <span class="loader-spinner"></span>
                        Processing...
                    </span>
                </button>
                <p class="submit-hint">This will trigger the full AI processing pipeline</p>
            </div>
        </section>

        <!-- Right Panel: Pipeline Visualization -->
        <section class="panel panel-pipeline">
            <div class="panel-header">
                <div class="panel-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                </div>
                <h2 class="panel-title">Processing Pipeline</h2>
                <div class="pipeline-timer hidden" id="pipelineTimer">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                    <span id="timerValue">00:00</span>
                </div>
            </div>

            <!-- Pipeline Steps -->
            <div class="pipeline-container">
                <!-- Step 1: Email Classification -->
                <div class="pipeline-step" data-step="classification">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                            <polyline points="22,6 12,13 2,6" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Email Classification</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Classify email intent using NLP model</p>
                        <div class="step-result hidden">
                            <div class="result-card">
                                <span class="result-label">Category</span>
                                <span class="result-value category-return" id="resultCategory">RETURN</span>
                            </div>
                            <div class="result-card">
                                <span class="result-label">Confidence</span>
                                <div class="confidence-bar">
                                    <div class="confidence-fill" id="resultConfidenceFill" style="width: 99%"></div>
                                    <span class="confidence-value" id="resultConfidenceValue">99%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Document Parsing -->
                <div class="pipeline-step" data-step="parsing">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14 2 14 8 20 8" />
                            <line x1="16" y1="13" x2="8" y2="13" />
                            <line x1="16" y1="17" x2="8" y2="17" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Document Parsing</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Extract text from PDF invoices using LlamaParse</p>
                        <div class="step-result hidden">
                            <div class="result-files" id="parsedFiles">
                                <!-- Parsed files will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Defect Analysis -->
                <div class="pipeline-step" data-step="defect">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <polyline points="21 15 16 10 5 21" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Defect Analysis</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Analyze product images using Gemini Vision</p>
                        <div class="step-result hidden">
                            <div class="defect-analysis" id="defectAnalysis">
                                <span class="no-images-text">No defect images in this request</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: LLM Extraction -->
                <div class="pipeline-step" data-step="extraction">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12 2 2 7 12 12 22 7 12 2" />
                            <polyline points="2 17 12 22 22 17" />
                            <polyline points="2 12 12 17 22 12" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>LLM Data Extraction</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Extract structured order details using Gemini 3</p>
                        <div class="step-result hidden">
                            <button class="view-json-btn" data-json="extracted">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                                    height="14">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                    <polyline points="14 2 14 8 20 8" />
                                </svg>
                                View Extracted Data
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 5: DB Verification -->
                <div class="pipeline-step" data-step="verification">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <ellipse cx="12" cy="5" rx="9" ry="3" />
                            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" />
                            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Database Verification</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Verify order details against orders database</p>
                        <div class="step-result hidden">
                            <!-- Dynamic sub-steps container for MCP agent tool calls -->
                            <div class="substeps-container dynamic-substeps" id="verificationSubsteps">
                                <!-- Sub-steps will be dynamically added as MCP tools are called -->
                            </div>
                            <div class="verification-result" id="verificationResult" style="display: none;">
                                <div class="verification-icon success">
                                    <svg class="icon-success" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                        <polyline points="22 4 12 14.01 9 11.01" />
                                    </svg>
                                    <svg class="icon-review" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" style="display: none;">
                                        <circle cx="12" cy="12" r="10" />
                                        <line x1="12" y1="8" x2="12" y2="12" />
                                        <line x1="12" y1="16" x2="12.01" y2="16" />
                                    </svg>
                                </div>
                                <div class="verification-text">
                                    <span class="verification-status">Order Verified</span>
                                    <span class="verification-details">Customer & order matched in database</span>
                                </div>
                            </div>
                            <button class="view-json-btn" data-json="verified">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                                    height="14">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                    <polyline points="14 2 14 8 20 8" />
                                </svg>
                                View Verified Order
                            </button>
                        </div>

                    </div>
                </div>

                <!-- Step 6: Policy Adjudication -->
                <div class="pipeline-step" data-step="adjudication">
                    <div class="step-connector"></div>
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                            <line x1="12" y1="17" x2="12.01" y2="17" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Policy Adjudication</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Evaluate request against company return policy</p>
                        <div class="step-result hidden">
                            <div class="substeps-container" id="adjudicationSubsteps">
                                <div class="substep" data-substep="context">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">Build Context</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                                <div class="substep" data-substep="classify">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">Classify Category</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                                <div class="substep" data-substep="graph">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">Graph Traversal</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                                <div class="substep" data-substep="sources">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">Fetch Citations</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                                <div class="substep" data-substep="decision">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">LLM Decision</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                                <div class="substep" data-substep="explain">
                                    <span class="substep-indicator pending">â—‹</span>
                                    <span class="substep-name">Generate Explanation</span>
                                    <span class="substep-status">Pending</span>
                                    <div class="substep-detail"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Step 7: Final Decision -->
                <div class="pipeline-step final" data-step="decision">
                    <div class="step-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                            <polyline points="22 4 12 14.01 9 11.01" />
                        </svg>
                    </div>
                    <div class="step-content">
                        <div class="step-header">
                            <h4>Final Decision</h4>
                            <span class="step-status pending">Pending</span>
                        </div>
                        <p class="step-description">Generate automated response and action</p>
                        <div class="step-result hidden">
                            <div class="final-decision approved" id="finalDecision">
                                <div class="decision-badge" id="decisionBadge">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                        <polyline points="22 4 12 14.01 9 11.01" />
                                    </svg>
                                    <span id="decisionText">APPROVED</span>
                                </div>
                                <div class="decision-details">
                                    <div class="reasoning-section">
                                        <h5>ðŸ§  Reasoning</h5>
                                        <p class="decision-reasoning" id="decisionReasoning">Analyzing policy rules...
                                        </p>
                                    </div>
                                    <div class="explanation-section">
                                        <h5>ðŸ’¬ Customer Explanation</h5>
                                        <p class="customer-explanation" id="customerExplanation">Generating
                                            explanation...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Logs Panel -->
            <div class="agent-logs-section">
                <div class="logs-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <polyline points="4 17 10 11 4 5" />
                            <line x1="12" y1="19" x2="20" y2="19" />
                        </svg>
                        Agent Activity Log
                    </h3>
                    <button class="logs-toggle" id="logsToggle">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9" />
                        </svg>
                    </button>
                </div>
                <div class="logs-container" id="logsContainer">
                    <div class="log-entry info">
                        <span class="log-time">--:--:--</span>
                        <span class="log-message">System initialized. Select a demo scenario to begin...</span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- JSON Viewer Modal -->
    <div class="modal-overlay hidden" id="jsonModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Extracted Data</h3>
                <button class="modal-close" id="modalClose">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <pre id="jsonContent"><code></code></pre>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" id="copyJsonBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                    </svg>
                    Copy JSON
                </button>
                <button class="modal-btn primary" id="closeModalBtn">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>